<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 
    'self' 'unsafe-inline' 'unsafe-eval'
    https://maps.googleapis.com
    https://maps.gstatic.com
    https://www.gstatic.com
    https://apis.google.com
    https://accounts.google.com;
  connect-src
    'self'
    https://maps.googleapis.com
    https://maps.gstatic.com
    https://asia-northeast1-blissful-shore-458002-e9.cloudfunctions.net
    https://verifyusername-ictqzxcg5a-an.a.run.app
    https://searchplaces-ictqzxcg5a-an.a.run.app
    https://identitytoolkit.googleapis.com
    https://securetoken.googleapis.com
    https://accounts.google.com
    https://www.googleapis.com
    https://firestore.googleapis.com
    wss://firestore.googleapis.com;
  img-src 
    'self' 
    data: 
    https://maps.googleapis.com 
    https://maps.gstatic.com 
    https://maps.google.com 
    https://www.google.com;
  style-src 
    'self' 'unsafe-inline' 
    https://fonts.googleapis.com 
    https://maps.gstatic.com;
  font-src 
    'self' data: 
    https://fonts.gstatic.com;
  frame-src 
    'self' 
    https://accounts.google.com 
    https://*.firebaseapp.com 
    https://apis.google.com;
">
  <!-- 1) Firebase 初期化モジュール -->
  <script type="module" src="./firebase-init.js"></script>
  <!-- 2) アプリ本体 -->
  <script type="module" src="./main.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <h2>目的地近辺のベジタリアン料理のお店</h2>

<!-- ここから認証フォーム -->
<div id="auth-forms">
  <!-- サインアップ／選択メソッド -->
  <div id="signup-methods">
    <!-- フォームを開くだけのボタンなので id を別に -->
    <button id="btn-email-show">メールで登録</button>
    <button id="btn-google-signin">Google で続行</button>
  </div>

  <!-- メール登録フォーム（最初は非表示） -->
  <div id="signup-form" style="display:none; margin-top:1rem;">
    <h3>メールで新規登録</h3>
    <input id="signup-email"    type="email"    placeholder="メールアドレス" />
    <input id="signup-password" type="password" placeholder="パスワード（6文字以上）" />
    <!-- こちらが本当の「登録する」ボタン -->
    <button id="btn-email-signup">登録する</button>
    <p><a href="#" id="link-to-login">既にアカウントをお持ちの方はこちら</a></p>
  </div>

  <!-- ログインフォーム -->
  <div id="login-form" style="display:none">
    <h3>ログイン</h3>
    <input id="login-email"    type="email"    placeholder="メールアドレス" />
    <input id="login-password" type="password" placeholder="パスワード" />
    <button id="btn-login">ログイン</button>
  </div>
</div>
<!-- ここまで認証フォーム -->
<!-- ユーザー名照合フォーム（ログイン後に表示） -->
<div id="username-verification" style="display:none; margin:1rem 0;">
  <h3>ユーザー名の確認</h3>
  <p>ご所属の名簿に掲載されている「ユーザー名」を入力してください。</p>
  <input id="username-input" type="text" placeholder="ユーザー名を入力" />
  <button id="btn-verify-username">確認</button>
  <p id="username-error" style="color:red; display:none;">ユーザー名が名簿と一致しません。</p>
</div>


  <div id="controls" style="display: none;">
    <input id="location-input" type="text" placeholder="目的地を入力してください" />
    <button id="search-btn">検索</button>
  </div>
  <p class="note">
    ※ 「❗️」マークは「ベジタリアン」「ヴィーガン」などの検索結果に出るものの  
    ビジネスプロフィールに「ベジタリアン料理があるお店」の表記がないお店。  
    ベジタリアンメニューがあるかどうかはとりわけ要確認。
  </p>
  <div class="map-container">
    <div id="map"></div>
    <ul id="results"></ul>
  </div>

<script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqBaGedqbzQ5ad-6_0-_JNKy2BDILsqGA&libraries=places,geometry&callback=initMap">
</script>
</body>
</html>
